# pandey_et_al_2022
## overview 
Reproduction of MD ATP and ATP Pyrene simulation from *pandey et al (2022)*'s work. (https://pubs.acs.org/doi/full/10.1021/acs.jpcb.2c06077)
| System | ATP | Mg 2+ | Pyrene | NA + | CL -  | Simulation time (ns) | replicas |
|-  | - | -| -| - | - | - | - |
| ATP | 30 | 30 | 0 | 68 | 8 | 1000| 1 |
| ATP & pyrene  | 30 | 30 | 10 | 68 | 8 | 1000 | 3 |

# files
* `charmm36_ljpme-jul2021.ff` - CHARMM36 forcefield with modified ion charges
   * `ions.itp` - modified charges on CLA SOD MG by scaling of 0.6
* atp_pan
   * `old_topol.top` - original topology file without modified nucleotide charges
   * `scaledtopol.top` - scaled charge topology file 
   * `atp.pdb` - ATP PDB sourced from CHARMM-GUI Archive - Small molecule database: https://charmm-gui.org/?doc=archive&lib=csml

# ATP simulation without Mg 
* `gmx insert-molecules -ci atp.pdb -o atp_30box.pdb -box 5 5 5 -nmol 30` - generates a 5nm box with 30 atp molecules 
* `gmx pdb2gmx -f atp_30box.pdb -o atp30_pro.gro -water tip3p` - generates topology file
* topology is modified to scale charges refer to modified nucelotide charges below.
* `gmx solvate -cp atp_30box.gro -cs spc216.gro -o atp_solv.gro -p topol.top`
* `gmx grompp -f ions.mdp -c atp_solv.gro -p topol.top -o ions.tpr`
* `gmx genion -s ions.tpr -o 1iee_solv_ions.gro -p topol.top -pname SOD -pq 0.6 -nname CLA -nq 0.6 -conc 0.1 -neutral`
# ATP simulation with Mg
* include: `gmx genion -s ions.tpr -o 1iee_solv_ions.gro -p topol.top -pname MG -pq 1.2 -np 30` before NaCl buffer.
## modified nucleotide charges (charmm36)
charges required to be scaled within `topol.top` generated by `gmx pdb2gmx`, shown via an example below. A charge scaling factor of 0.6 was used.  

| nr | type | resnr | residue | atom | cgnr  | charge | mass |
|-  | - | -| -| - | - | - | - |
| 28 | CN8B | 1 | ATP | C5' | 5 | -0.08 | 12.011 |
| 28 scaled| CN8B | 1 | ATP | C5' | 5 | -0.048 | 12.011 |

This is performed for all cgnr groups of multiple of 5s (this can vary but in my case nr 28 - 43 were scaled). This represents the phosphate group that contributes a charge of -4, rescaled to -2.4. The example topology for this simulation is `scaledtopol.top`. The ions were also scaled within `ions.itp` in forcefield. 

| | ATP | Mg 2+  | NA + | CL -  | Total |
|-  | - | -| - | - | - |
| molecules | 30 | 30 | 68 | 8 | 136| 
| scaled charge  | -72 | 36 | 40.8 | -4.8 | 0 | 



# ATP Pyrene Simulation
